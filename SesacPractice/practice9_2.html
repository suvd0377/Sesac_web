<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>핸드폰 사용 시간</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <!-- Sweetalert2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Sweetalert2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
</head>
<body>
  <div class="container mt-5">
    <h2 class="text-center">핸드폰 사용 시간 추적기</h2>
    
    <div class="card mt-3">
      <div class="card-body">
        <h5 class="card-title">오늘의 사용 시간 입력</h5>
        <form id="usageForm">
          <div class="form-group">
            <label for="usageTime">사용 시간 (시간 단위)</label>
            <input type="number" class="form-control" id="usageTime" placeholder="예: 2" required>
          </div>
          <button type="submit" class="btn btn-primary">입력</button>
        </form>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-body">
        <h5 class="card-title">일주일 사용 시간</h5>
        <canvas id="usageChart" width="400" height="200"></canvas>
      </div>
    </div>

    <div class="text-center mt-3">
      <button class="btn btn-info" onclick="showTotalUsage()">전체 사용 시간 보기</button>
    </div>
  </div>

  <script>

    let usageData = [0, 0, 0, 0, 0, 0, 0]; 
    let labels = [];
    let currentDay = new Date().getDay(); 
    
    const dayLabels = ['일', '월', '화', '수', '목', '금', '토'];

    for (let i = 0; i < 7; i++) {
      let labelDate = new Date();
      labelDate.setDate(labelDate.getDate() - (currentDay - i));
      labels.push(dayLabels[(currentDay - i + 7) % 7] + " (" + labelDate.toLocaleDateString() + ")");
    }

    document.getElementById('usageForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const usageTime = parseFloat(document.getElementById('usageTime').value);
      const todayIndex = currentDay; 
      usageData[todayIndex] += usageTime;


      Swal.fire({
        icon: 'success',
        title: '입력 완료!',
        text: `${dayLabels[todayIndex]}에 사용한 시간은 ${usageTime}시간입니다.`
      });


      updateChart();
    });


    const ctx = document.getElementById('usageChart').getContext('2d');
    const usageChart = new Chart(ctx, {
      type: 'bar', 
      data: {
        labels: labels,
        datasets: [{
          label: '일주일 동안 핸드폰 사용 시간 (시간)',
          data: usageData,
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    function updateChart() {
      usageChart.update();
    }

    function showTotalUsage() {
      const totalUsage = usageData.reduce((acc, time) => acc + time, 0);
      const avgUsage = (totalUsage / usageData.length).toFixed(2);
      Swal.fire({
        title: '사용 통계',
        text: `전체 사용 시간: ${totalUsage}시간\n평균 사용 시간: ${avgUsage}시간`,
        icon: 'info'
      });
    }
  </script>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>

